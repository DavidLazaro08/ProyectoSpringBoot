<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Facturas</title>
    <link rel="stylesheet" th:href="@{/css/facturas.css}">
</head>

<body>

    <h1>Gestión de Facturas</h1>

    <a href="/" class="nav-link">← Volver al inicio</a>

    <div class="search-form">
        <form method="get" action="/facturas">
            <input type="email" name="email" placeholder="Ingrese email del usuario" th:value="${email}" required>
            <button type="submit">Buscar</button>
        </form>
    </div>

    <div th:if="${mensaje}" th:class="'mensaje ' + ${tipoMensaje != null ? tipoMensaje : 'error'}" th:text="${mensaje}">
    </div>

    <div th:if="${facturas != null}">
        <div th:if="${facturas.isEmpty()}" class="no-facturas">
            <p>No se encontraron facturas para este email.</p>
        </div>

        <div th:if="${!facturas.isEmpty()}">
            <table>
                <thead>
                    <tr>
                        <th>Fecha</th>
                        <th>Importe Base</th>
                        <th>Impuesto</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="factura : ${facturas}">
                        <td th:text="${#temporals.format(factura.fecha, 'dd/MM/yyyy HH:mm')}"></td>
                        <td th:text="${#numbers.formatDecimal(factura.importe, 1, 2)} + ' €'"></td>
                        <td th:text="${#numbers.formatDecimal(factura.impuesto, 1, 2)} + ' €'"></td>
                        <td th:text="${#numbers.formatDecimal(factura.total, 1, 2)} + ' €'"></td>
                    </tr>
                </tbody>
            </table>

            <form method="post" action="/facturas/renovar">
                <input type="hidden" name="email" th:value="${email}">
                <button type="submit" class="renovar-btn">Renovar ahora (demo)</button>
            </form>
        </div>
    </div>

</body>

</html>